'use strict';

window.fileUploader = function (id, op) {
    var el = document.getElementById(id);
    var input = document.createElement('input');
    input.setAttribute('type', 'file');
    input.setAttribute('id', 'de-uploader');
    el.appendChild(input);
    input.addEventListener("change", function (e) {
        var file = e.target.files[0];
        //创建formdata对象
        var formdata = new FormData();
        formdata.append("file", file);
        var xhr = new XMLHttpRequest();
        xhr.open("post", op.action);
        //回调
        xhr.onreadystatechange = function (e) {
            if (xhr.readyState == 4 && xhr.status == 200) {
                op.success(xhr);
            }
        };
        //将formdata上传
        xhr.send(formdata);
    });
};
